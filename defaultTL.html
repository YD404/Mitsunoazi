<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unity Project "Mitsunoazi" defaultTL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Noto Sans JP', 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #111827;
        }
        .container {
            max-width: 1024px;
        }
        .card {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        h1, h2, h3, h4 {
            font-weight: 700;
        }
        .icon {
            width: 24px;
            height: 24px;
            stroke-width: 2;
        }
        .description-box {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.25rem;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold mb-2">Project "Mitsunoazi"</h1>
            <p class="text-lg text-gray-600">defaultTL仕様書</p>
        </header>

        <!-- Ambiance Flow Section -->
        <section id="ambiance-flow" class="mb-12">
            <div class="card p-8">
                <div class="flex items-center mb-6">
                    <i data-lucide="waypoints" class="icon text-gray-700 mr-3"></i>
                    <h2 class="text-2xl font-semibold">背景演出の処理フロー</h2>
                </div>
                <div class="space-y-2">
                    <!-- Step 1 -->
                    <div class="flow-step">
                        <button class="w-full flex items-center justify-between p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition cursor-pointer text-left accordion-header">
                            <span class="flex items-center">
                                <i data-lucide="timer" class="mr-3 text-gray-600"></i>
                                <span class="font-semibold">1. 待機と順番決定</span>
                            </span>
                            <i data-lucide="chevron-down" class="toggle-icon transition-transform duration-300"></i>
                        </button>
                        <div class="accordion-content hidden p-4 bg-white border border-t-0 border-gray-200 rounded-b-lg">
                            <p class="text-gray-700"><strong class="font-semibold">Director.cs</strong> は、設定された<code class="text-sm bg-gray-200 p-1 rounded">minSpawnInterval</code>と<code class="text-sm bg-gray-200 p-1 rounded">maxSpawnInterval</code>の間のランダムな秒数だけ待機します。待機後、あらかじめ定められたシーケンスに基づき、次にプレハブを生成するエリア（例：右上→右下→…）を決定します。</p>
                        </div>
                    </div>
                    <div class="flex justify-center py-1"><i data-lucide="arrow-down" class="text-gray-400"></i></div>
                    <!-- Step 2 -->
                    <div class="flow-step">
                        <button class="w-full flex items-center justify-between p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition cursor-pointer text-left accordion-header">
                            <span class="flex items-center">
                                <i data-lucide="check-square" class="mr-3 text-gray-600"></i>
                                <span class="font-semibold">2. エリア使用状況の確認</span>
                            </span>
                            <i data-lucide="chevron-down" class="toggle-icon transition-transform duration-300"></i>
                        </button>
                        <div class="accordion-content hidden p-4 bg-white border border-t-0 border-gray-200 rounded-b-lg">
                            <p class="text-gray-700"><strong class="font-semibold">Director.cs</strong> は、次にプレハブを生成する予定のエリアに、既存のプレハブが存在しないかを確認します。もし他のプレハブがまだ表示されている場合は、それが破棄されるまで1秒ごとにチェックを繰り返して待機します。</p>
                        </div>
                    </div>
                    <div class="flex justify-center py-1"><i data-lucide="arrow-down" class="text-gray-400"></i></div>
                    <!-- Step 3 -->
                    <div class="flow-step">
                        <button class="w-full flex items-center justify-between p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition cursor-pointer text-left accordion-header">
                            <span class="flex items-center">
                                <i data-lucide="package-plus" class="mr-3 text-gray-600"></i>
                                <span class="font-semibold">3. プレハブの選択と生成</span>
                            </span>
                            <i data-lucide="chevron-down" class="toggle-icon transition-transform duration-300"></i>
                        </button>
                        <div class="accordion-content hidden p-4 bg-white border border-t-0 border-gray-200 rounded-b-lg">
                            <p class="text-gray-700">エリアが空いていることを確認後、<strong class="font-semibold">Director.cs</strong> は設定された出現頻度に基づき、2種類のプレハブパターンから1つを選択します。その後、<strong class="font-semibold">QuadrantPositioner.cs</strong> を利用して正確な生成座標を計算し、プレハブをシーン内にインスタンス化（生成）します。</p>
                        </div>
                    </div>
                    <div class="flex justify-center py-1"><i data-lucide="arrow-down" class="text-gray-400"></i></div>
                    <!-- Step 4 -->
                    <div class="flow-step">
                        <button class="w-full flex items-center justify-between p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition cursor-pointer text-left accordion-header">
                            <span class="flex items-center">
                                <i data-lucide="trash-2" class="mr-3 text-gray-600"></i>
                                <span class="font-semibold">4. 自動破棄タイマーの開始と完了</span>
                            </span>
                            <i data-lucide="chevron-down" class="toggle-icon transition-transform duration-300"></i>
                        </button>
                        <div class="accordion-content hidden p-4 bg-white border border-t-0 border-gray-200 rounded-b-lg">
                            <p class="text-gray-700">生成されたプレハブにアタッチされている <strong class="font-semibold">DestroyAfterTime.cs</strong> が起動し、自身の<code class="text-sm bg-gray-200 p-1 rounded">lifetime</code>変数に設定された秒数のカウントダウンを開始します。時間が経過すると、プレハブは自動的にシーンから破棄されます。これにより、そのエリアは再び空き状態となり、新しいプレハブが生成可能になります。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Script Details Section -->
        <section id="script-details" class="mb-12">
            <div class="card p-8">
                <div class="flex items-center mb-6">
                    <i data-lucide="file-code-2" class="icon text-gray-700 mr-3"></i>
                    <h2 class="text-2xl font-semibold">スクリプト個別解説</h2>
                </div>
                
                <!-- Ambiance Layer -->
                <div class="mb-12">
                    <h3 class="text-xl font-semibold mb-6 pb-2 border-b border-gray-200 flex items-center">
                        <i data-lucide="sparkles" class="mr-2 h-5 w-5 text-cyan-600"></i>背景演出層 (Ambiance Layer)
                    </h3>
                    <div class="space-y-6">
                        <div class="p-6 bg-gray-50 rounded-lg">
                            <h4 class="text-lg font-semibold mb-3">Director.cs</h4>
                            <div class="description-box text-gray-800">
                                <p>背景演出プレハブの生成を管理する司令塔。設定された順序とランダムな間隔に従い、画面の四隅にアニメーションプレハブを自動配置します。</p>
                            </div>
                        </div>
                        <div class="p-6 bg-gray-50 rounded-lg">
                            <h4 class="text-lg font-semibold mb-3">DestroyAfterTime.cs</h4>
                            <div class="description-box text-gray-800">
                                <p>オブジェクトにアタッチし、指定時間後に自己破壊させるタイマー。リソースの自動クリーンアップを実現します。</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Utility Layer -->
                <div>
                    <h3 class="text-xl font-semibold mb-6 pb-2 border-b border-gray-200 flex items-center">
                        <i data-lucide="wrench" class="mr-2 h-5 w-5 text-orange-600"></i>ユーティリティ層 (Utility Layer)
                    </h3>
                    <div class="space-y-6">
                        <div class="p-6 bg-gray-50 rounded-lg">
                            <h4 class="text-lg font-semibold mb-3">QuadrantPositioner.cs</h4>
                             <div class="description-box text-gray-800">
                                <p>画面の四隅の中心座標を計算して返す静的クラス。解像度に依存しない正確な位置決めをサポートします。</p>
                            </div>
                        </div>
                        <div class="p-6 bg-gray-50 rounded-lg">
                            <h4 class="text-lg font-semibold mb-3">QuadrantPlacer.cs</h4>
                            <div class="description-box text-gray-800">
                                 <p>Unityエディタ上でオブジェクトを四隅に簡単に配置するためのツール。インスペクタから選択するだけで即座に移動できます。</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <script>
        lucide.createIcons();

        document.addEventListener('DOMContentLoaded', () => {
            const accordionHeaders = document.querySelectorAll('.accordion-header');
            accordionHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const icon = header.querySelector('.toggle-icon');
                    
                    content.classList.toggle('hidden');
                    icon.classList.toggle('rotate-180');
                });
            });
        });
    </script>
</body>
</html>

